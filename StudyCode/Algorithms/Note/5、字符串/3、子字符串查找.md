# 子字符串查找

给定一段长度为 N 的文本和一个长度为 M 的模式（pattern）字符串。在文本中找到一个和该模式相同的子字符串。

## 历史简介

## 暴力子字符串查找算法

```
<?php

function search($pat, $txt){
    $M = strlen($pat);
    $N = strlen($txt);

    for ($i = 0; $i <= $N - $M; $i++){ // 从 0 到 N - M 开始对每个位置进行对比
        for ($j = 0; $j < $M; $j++){ // 开始对比 txt 的第 i 个位置，需要将 pat 的每个字符与 txt 相应位置的字符进行对比
            if ($txt[$i + $j] != $pat[$j]){ // txt 的第 i + j 个字符相对应的就是 pat 第 j 个字符
                break;
            }
        }

        if ($j == $M){
            return $i; // 找到匹配
        }
    }

    return $N; // 未找到匹配
}


echo search('as', 'ag112123asd1');
```

显式回退

```
<?php

function search($pat, $txt){
    $M = strlen($pat);
    $N = strlen($txt);

   for ($i = 0, $j = 0; $i < $N && $j < $M; $i++){ // i 跟踪文本，j 跟踪模式
       if ($txt[$i] == $pat[$j]){
           $j++; // 如果相等，就在下一次循环中比较 pat 的下一个字符，txt 也会比较下一个字符。直到 j = M 时会不满足循环条件然后跳出循环，即表示匹配成功
       } else { // 如果不相等，i 需要回退到这一次匹配开始时的位置，然后在下一个循环进入下一个位置。 同时 j 也重置为 0；
           $i -= $j;
           $j = 0;
       }
   }

   if ($j == $M){
       return $i - $M; // 找到匹配
   } else {
       return $N; // 未找到匹配
   }
}


echo search('as', 'ag112123asd1');
```

## Knuth-Morris-Pratt 子字符串查找算法

在匹配失败时，我们总是可以让模式指针回退，而不必回退文本指针。

#### 模式指针的回退

在 KMP 子字符串查找算法中，不会回退文本指针。而是用一个数组 dfa[] [] 来记录匹配失败时模式指针应该回退多远。

#### KMP 查找算法

#### DFA 模拟

